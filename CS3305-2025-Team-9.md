# LET ME COOK 
https://github.com/BadWolf02/LetMeCook

## 1. Overview & Purpose


### 1.1 The Problem
We found ourselves often not looking at the fridge, not knowing what to cook. As well as going to get groceries, only to realise that the shpping list was left at home. Or maybe you brought the shopping list, but you just thought of a addistional dish you want to make only to realise that you have no idea if you currenly have all of the ingredients or if you need to get some because you don't know what is in the fride. You decide to get the ingredients you think you still need just to get home to realise you now have two of the same thing - one was already in the fridge and you just bought another one.
On top of that you realise that something that you were sure was in the fridge when you left has been used by your sister in the meantime. Next your mum walks in, saying that she would have asked you to grab her a couple of thing if she had known you were going. 
These situations very annoying, even when it only one of these scenarioues happens at one point in time and they are very annoying, and frankly just make life unnecessary hard.
There are individual apps that leet you make shopping lists or apps that will suggest recipes based on specific ingredients you list or have or apps that work as cookbooks and allow you to search for recipes. 
However none of them seem to do all things in well in one app and even if they come close you are still left with the probelem of other people living in the same household using things without you knowing or wanting something from the shop and not knowing about it.

### 1.2 The Solution, Our App
Introducing our App: Let Me Cook. An app that allows you to browse recipes, to search for them, as well as to keep track of the houshold inventory, add things to the household shopping list. When viewing a recipe there is the option to add things automatically to the shoping list if they are not pressent in the inventory. The inventory is easier to keep track of than a traditional inventory as barcode scanning was incorpotated saving time for adding items to the inventory, making it more likeley that users will keep the inventory up to date due to ease of use.

## 2. Architecture

### 2.1 High Level View
![team9_letmecook-architecture.jpg](report-imgs%2Fteam9_letmecook-architecture.jpg)

Figure 2.1: LetMeCook Architecture

Almost every feature of our app requires a persistent connection, or at least regular syncing with a 
3rd party service. 

#### 2.1.1 Firebase Firestore
Firebase Firestore (Firestore) is a **NoSQL document-based** database. It allows apps to store and sync data in 
real time **asynchronously**. It offered the following additional benefits:
- Offline support. Data can be accessed and modified offline and synced when online.
- Google's security guarantees.
- Large number of reads and writes for free

We used Firestore to store the majority of our data, except for sensitive user data and images. 
We used Firestore to store the following collections and fields:
- Households
  - Household name
  - Inventory
  - Invited users
  - Members
  - Shopping list
- Ingredients
  - Name
  - ID
  - Allergens
  - Calories
  - Category
  - Serving size
- Recipes
  - Name
  - Author
  - Cuisine
  - Type
  - Allergens
  - Ingredients
  - Steps
  - Average rating
  - Reviews
- Users
  - Email
  - Username
  - Household Document ID
  - Invites
  - Favourite Recipes

#### 2.1.2 Firebase Authentication
Firebase Authentication is a service that provides secure user authentication for apps. It supports multiple 
authentication methods and simplifies user management, handles **session persistence**, and integrates with 
Firebase Firestore for user-based data security. It allows easy implementation of **password restrictions** 
and allows disabling/deleting accounts from a console.

In our case we used **email authentication and verification**. Our users could remain logged in after refreshing 
the app or closing their phone. We stored the generated user ID from Authentication in Firestore as a 
user's document ID to verify user details.


#### 2.1.3 Firebase Storage
Firebase Storage is a cloud service used for storing and fetching **user-generated files**, such as images, 
videos, and documents. It allows:
- Scalable storage with Google Cloud infrastructure
- Secure file access using Firebase Authentication and Firestore Security Rules
- Efficient uploads & downloads with automatic handling of network interruptions
- Direct URL sharing for accessing stored files

We used Firebase Storage to store images for recipes, which are uploaded when a user creates 
a recipe or scrapes one from the web.

#### 2.1.4 ML Kit

#### 2.1.5 OpenFoodFacts

#### 2.1.6 BBC Good Foods

### 2.2 Android Architecture

#### 2.2.1 Activities and Fragments
An **Activity** is a single, focused thing in an app. Data persists while the activity is running.
A **Fragment** is a component that lives inside an Activity and depends on its lifecycle.

We used Fragments for our primary 5 pages, navigated to via the navigation bar. These pages run 
on the **MainActivity**. This ensured smooth navigation and that the main interactable pages would have 
their data remain loaded. We used Activities to open smaller pages with a **shorter lifecycle**. 

#### 2.2.2 Model-View-ViewModel (MVVM) Architecture
![team9_mvvm.png](report-imgs%2Fteam9_mvvm.png)

Figure 2.2: MVVM Architecture

MVVM is a software design pattern commonly used in Android development to separate concerns and improve 
code organization. Its components include:
- **Model**: Represents the data layer
- **View**: Represents the UI layer
- **ViewModel**: Acts as a bridge between the two layers.

We constantly aimed to adhere to this architecture, but found fragments to be difficult to work with so we
deviated in strictly using the ViewModel in some fragments.

// add architecture overview, look up names of different architectures

### 2.3 Dependencies & Other Resources
We made use of a variety of dependencies. Many of them were built into Android and Android Studio for
our development environment. Below are some keys resources that were used to aid in the development of
our app.

#### 2.3.1 Glide
Glide is an open-source image loading library for Android. It can load images from Firebase Storage 
and efficiently caches images on retrieval.

#### 2.3.2 Google Fonts
Google provides a large variety of standardised images, symbols and logos for Android in XML format for download. 
We made use of a wide variety of these throughout our app.


### use case diagram??
### architecutre of Activity and intents, drawn with eg. text underneath describing it as well as mentioning which of our other java classes use this
### Explanation of data model, mention single source of truth if we use it + control based access if I still manage to implement the authorname and the 

## 3. Main Components
The components will be broken down by page then by feature. We will highlight what happens when a
user interacts with something on screen.
We generally provide feedback to the user in the form of a Toast, which is an alert that appears with
some text. Otherwise the user will see visible change on their screen.

### 3.1 SearchDB
All methods used to retrieve data from our Firestore database were stored in the SearchDB class. The class
listeners for all relevant data types and search methods which callback to the listeners. This file is imported
in almost every other file to display data. 

### 3.2 Sign Up
![team9_signup.jpg](report-imgs%2Fteam9_signup.jpg)

Figure 3.1: Sign Up page screenshot

The Sign Up page allows users to enter a unique username, an email and a password which must follow the
displayed restrictions. The Login button redirects to the Login page. The Sign Up button will then
store the entered data and check if the details are valid.

### 3.2.1 Account Creation
When the user signs up, we first check if the fields are empty and then check if the username 
exists already. If both of these pass, we pass this data to Firebase Authentication to create an account.

Firebase Authentication checks for a valid email and password restrictions. It also checks if the email
exists in our database. The account is created in Firebase Authentication with a user ID (UID) and their
password is hashed. The user is then sent a verification email.

Once the account is created in Firebase Authentication, we generate and store additional account details 
in Firestore, as listed in the Firestore section. We generate a household ID and created a household
where the user is the only member.

### 3.2.2 Verification
![team9_verification.jpg](report-imgs%2Fteam9_verification.jpg)

Figure 3.2: Verification email screenshot

In the user's inbox, they will receive the following email which redirects to a blank page saying 
Verification Successful. Their account is now verified and is eligible for login.

### 3.3 Login
![team9_login.jpg](report-imgs%2Fteam9_signup.jpg)

Figure 3.3: Login page screenshot

The user may enter an email and a password into the relevant fields and log in using the Login button. 
The Sign Up button redirects to the Sign Up page.

When pressing the Login button. We first check if any of the fields are empty. Firebase Authentication 
checks the email and password and checks if the email is verified. If this is successful, we create an
intent to move to the MainActivity. The UID is persistently stored so that it can be used to query the
database.


### 3.4 Home Page
![team9_homepage.jpg](report-imgs%2Fteam9_homepage.jpg)

Figure 3.4: Home page screenshot

The home page is navigated to by the navbar and is a fragment on the MainActivity. It holds the 
following features.

#### 3.4.1 Recipe List
This is a RecyclerView which contains an image and name of a recipe. A RecyclerView is a dynamic
list that can hold a specific xml file to create custom list items. This list by default will show
all results. If the list would go over 6 values, a Next Button appears, offering pagination so the
user can scroll. If there is no next page, the button disappears. A Previous Button will also appear
when scrolling, going back a page and disappearing if at the start of the list. When a list item is
pressed, it opens the RecipeViewActivity and passes over the recipe's ID.

#### 3.4.2 Recipe Filtering
There are 2 possible inputs for the user to filter in the two text boxes; recipe name and author.
The Search button will take the text in these inputs and pass them to a filterRecipe function. This
will display all results that match the combination of inputs. If there are no results, the default 
list will appear. The filterRecipe function offers additional inputs which are not currently
implemented, such as searching by cuisine. If the user presses the Reset Button, the default list
will appear.

#### 3.4.3 What Can I Cook?
The What Can I Cook button functions similarly to the Recipe Filtering. Every recipe in the database is
looped through and their ingredients are stored. The user's household inventory is fetched and checked
for each recipe ingredient. If all ingredients are present in the inventory, the recipe is added to a 
return list to be displayed. This is displayed in the Recipe List.

### 3.5 Recipe View
![team9_recipeview.jpg](report-imgs%2Fteam9_recipeview.jpg)

Figure 3.5: Recipe View page screenshot. Details, favourite, add to shopping list

![team9_recipeview2.jpg](report-imgs%2Fteam9_recipeview2.jpg)

Figure 3.6: Continuation of Recipe View page. Reviews.

This page is focused around the user interacting with a recipe they pressed in the Home page.

#### 3.5.1 Recipe Details
All data from the recipe is formatted and displayed to the user in a visually appealing and easy to
read way. This information is not interactable.

#### 3.5.2 Favourite Button
The Favourite Button is used to store a recipe in the user's favourite recipes which is displayed on
another page. It adds the recipe's ID to the user's Firestore document.

#### 3.5.3 Add to Shopping List Button
The Add to Shopping List Button fetches the recipe's ingredients, the user's household inventory and
the user's household shopping list. The ingredients list is looped through and if it is not present
in the inventory, it is stored in a return list. The return list is then looped through and checks
if any ingredient is in the shopping list. If it is, it is removed from the return list. The list is 
then returned, where it contains all ingredients from the recipe that are not in the inventory or on
the shopping list.

#### 3.5.4 Reviews
The user can add reviews by picking a star rating and writing text for the review. The Review button
submits the written review. The Reviews array in Firestore are then updated with the rating, the
comment and the username of the user. The recipe's average rating is then recalculated by checking all
current reviews, averaging them and rounding them to the nearest 0.5.

### 3.6 Chef's Corner (Recipe Creation)

![team9_chefscorner.jpg](report-imgs%2Fteam9_chefscorner.jpg)

Figure 3.7: Chef's Corner page screenshot. Name, meal type, ingredients, steps, cuisine, time spent cooking.

![team9_chefscorner2.jpg](report-imgs%2Fteam9_chefscorner2.jpg)

Figure 3.8: Continuation of Chef's Corner page. Cuisine, time spent cooking, time spent prepping, 
add recipe, select image, scraping.

**MEGAN PLEASE !!!!!!!!!!!!!**

### 3.7 Inventory Page
![team9_inventory.jpg](report-imgs%2Fteam9_inventory.jpg)

Figure 3.9: Inventory page screenshot.

#### 3.7.1 Ingredient List
![team9_ingredient-db-item.png](report-imgs%2Fteam9_ingredient-db-item.png)

Figure 3.10: Sample ingredient in Firestore database.

#### 3.7.2 Barcode Scanning
![team9_scanner.jpg](report-imgs%2Fteam9_scanner.jpg)

Figure 3.11: Barcode scanning a pringles can.

### 3.8 Shopping Page
![team9_shoppinglist.jpg](report-imgs%2Fteam9_shoppinglist.jpg)

Figure 3.12: Shopping page screenshot

The shopping list page contains a text input, a dropdown select menu and a list of all shopping list 
items along with a remove button. Items can be added by selecting from the database's list of 
ingredients in the dropdown menu, or by custom writing an item in the text input. Items added to 
the shopping list by the Add To Shopping List Button will be displayed here. Each item in the list 
is displayed with a name and a button with an X which removes the item from the list when clicked.

### 3.9 User Page
![team9_userpage.jpg](report-imgs%2Fteam9_userpage.jpg)

Figure 3.13: User page screenshot

The user page is the hub for all account management.

#### 3.9.1 User Details
The user's username, email and household ID are displayed for the user to see in this section. This 
information is updated if it is changed elsewhere. The user's profile picture is also displayed.

#### 3.9.2 Edit Profile
![team9_edit-profile.jpg](report-imgs%2Fteam9_edit-profile.jpg)

Figure 3.14: Edit Profile page screenshot

**NUTSA PLEASE !!!!!!!!!!!!!**

#### 3.9.3 Sign Out

### 3.10 Manage Household Page
![team9_managehousehold.jpg](report-imgs%2Fteam9_managehousehold.jpg)

Figure 3.15: Manage Household page screenshot

### 3.11 View Invites page
![team9_invites.jpg](report-imgs%2Fteam9_invites.jpg)

Figure 3.16: View Invites page screenshot

### 3.12 Favourite Recipes
![team9_favourites.jpg](report-imgs%2Fteam9_favourites.jpg)

Figure 3.17: Favourite Recipes page screenshot


## 4 Challanges &  Lessons learned
We experienced a wide variety of challenges, largely caused by interacting with new technologies. We have 
been lucky to be able to work with Java, a language that we are familiar with through our coursework, 
however this came with its own challenges. The Android development community no longer focuses its 
efforts on Java, but rather Kotlin.

### 4.1 Dependency clashes
**Morgan**

### 4.2 Poor Firebase documentation
We found the documentation for Firebase to be incredibly poor, lacking any mention of methods that are 
used in Firebase Firestore, Firebase Authentication or Firebase Storage. We found some useful functions 
in an **open-source GitHub repo** that showcased the various uses of Firebase. We additionally had 
to read various **Firebase blogs**, written by the community, to find reference to different 
functionalities, such as callbacks.

### 4.3 Asynchronous data retrieval
One of the largest issues was creating database searching methods to be reused in our activities. 
This was done for separation of concerns but we later realised how essential it was since 
Firebase Firestore queries are asynchronous.

We had to create listener functions, using a **callback-based approach**. New listeners were created for 
different data types and use them to return the relevant data for use in other methods. 
This resulted in code being written using **lambda functions** for our callback, which was new for us.

### 4.4 Android Studio corrupting Gradle builds
...

## 5 Contribution of Team members
Our group divided up tasks at each group meeting using a Kanban board on the website Trello. We filled
the Kanban board with tasks, noting importance as some tasks required others to be complete before beginning.
We commented on tasks with ideas and ways to expand and informed each other when we finished a task and 
discussed which to take on next. This form of delegation worked incredibly well as we began development 
with no group members having previous experience with app development.

### 5.1 Joseph 122320603
Of the features listed in Main Components I created:
- Methods in SearchDB associated with other components.
- Sign Up. Account Creation & Verification
- Login
- Sign Out
- Manage Household
- View Invites
- Shopping List
- Home Page. Recipe Filtering & Recipe List
- Recipe View. Reviews & Favourites

### 5.2 Nutsa

### 5.3 Jack

### 5.4 Morgan

### 5.5 Megan
